{"version":3,"sources":["common/SimpleEditor.tsx","modules/server-state/add-server-scenario/AddServerScenario.tsx","modules/server-state/ServerStateMenu.tsx","modules/server-state/ServerState.tsx"],"names":["SimpleEditor","initialCode","autoHeight","language","valueGetter","onReady","linesCount","split","length","height","editorDidMount","getter","current","value","trim","width","useStyles","makeStyles","theme","createStyles","closeButton","position","right","spacing","top","color","palette","grey","AddServerScenario","useState","open","setOpen","classes","useTheme","fullScreen","useMediaQuery","breakpoints","down","useContext","AppStateContext","addServerStateScenario","serverState","scenarioServerState","setScenarioServerState","name","setName","useRef","code","JSON","stringify","handleClose","a","id","Date","now","toString","state","parse","Button","onClick","Dialog","closeAfterTransition","aria-labelledby","maxWidth","onClose","DialogTitle","disableTypography","style","minWidth","Typography","variant","IconButton","aria-label","className","Close","DialogContent","TextField","autoFocus","fullWidth","label","margin","onChange","event","target","DialogContentText","DialogActions","ServerStateMenu","actions","anchorEl","setAnchorEl","Boolean","aria-controls","aria-haspopup","currentTarget","Menu","keepMounted","PaperProps","maxHeight","ITEM_HEIGHT","map","action","MenuItem","key","ServerState","resetServerState","updateServerState","deleteStateScenario","editing","setEditing","invalidJson","setInvalidJson","draftCode","setDraftCode","navigator","clipboard","readText","e","console","error","writeText","display","justifyContent","alignItems","disabled","Paper","padding","src","Editor","onSave"],"mappings":"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","file":"static/js/3.d16c690e.chunk.js","sourcesContent":["import MonacoEditor from '@monaco-editor/react';\nimport React, { MutableRefObject } from 'react';\n\nconst lineHeight = 18;\n\nexport function SimpleEditor({\n  initialCode,\n  autoHeight,\n  language,\n  valueGetter,\n  onReady,\n}: {\n  initialCode: string;\n  language: string;\n  autoHeight?: boolean;\n  valueGetter: MutableRefObject<any>;\n  onReady?(): void;\n}) {\n  function handleEditorDidMount(getter: (() => string) | undefined) {\n    onReady && onReady();\n    valueGetter.current = getter;\n  }\n\n  const linesCount = initialCode.split(/\\r\\n|\\r|\\n/).length + 3;\n  const height = autoHeight ? `${linesCount * lineHeight}px` : '500px';\n\n  return (\n    <MonacoEditor\n      editorDidMount={handleEditorDidMount}\n      height={height}\n      language={language}\n      value={initialCode.trim()}\n      width=\"100%\"\n    />\n  );\n}\n","import { IconButton, Typography, useMediaQuery } from '@material-ui/core';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport {\n  createStyles,\n  makeStyles,\n  Theme,\n  useTheme,\n} from '@material-ui/core/styles';\nimport TextField from '@material-ui/core/TextField';\nimport { Close } from '@material-ui/icons';\nimport React, { ChangeEvent, useContext, useRef, useState } from 'react';\nimport { ServerState } from '../../../../sharedTypes';\nimport { AppStateContext } from '../../../App';\nimport { SimpleEditor } from '../../../common/SimpleEditor';\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    closeButton: {\n      position: 'absolute',\n      right: theme.spacing(1),\n      top: theme.spacing(1),\n      color: theme.palette.grey[500],\n    },\n  }),\n);\n\nexport default function AddServerScenario() {\n  const [open, setOpen] = useState(false);\n  const classes = useStyles();\n  const theme = useTheme();\n  const fullScreen = useMediaQuery(theme.breakpoints.down('xs'));\n  const { addServerStateScenario, serverState } = useContext(AppStateContext);\n  const [scenarioServerState, setScenarioServerState] = useState(\n    {} as ServerState,\n  );\n  const [name, setName] = useState('');\n  const valueGetter = useRef<() => string>();\n  const code = JSON.stringify(scenarioServerState, null, 2);\n\n  function handleClickOpen() {\n    setOpen(true);\n    setScenarioServerState(serverState);\n  }\n\n  function handleClose() {\n    setOpen(false);\n  }\n\n  function handleNameChange(event: ChangeEvent<HTMLInputElement>) {\n    setName(event.target.value);\n  }\n\n  async function handleSubmit() {\n    if (valueGetter.current) {\n      await addServerStateScenario({\n        id: Date.now().toString(),\n        name,\n        state: JSON.parse(valueGetter.current()) as ServerState,\n      });\n      setOpen(false);\n    }\n  }\n\n  return (\n    <>\n      <Button onClick={handleClickOpen}>Add server scenario</Button>\n      <Dialog\n        closeAfterTransition\n        aria-labelledby=\"max-width-dialog-title\"\n        fullScreen={fullScreen}\n        maxWidth=\"md\"\n        open={open}\n        onClose={handleClose}\n      >\n        <DialogTitle\n          disableTypography\n          id=\"max-width-dialog-title\"\n          style={{ minWidth: 500 }}\n        >\n          <Typography variant=\"h6\">Add server scenario</Typography>\n          <IconButton\n            aria-label=\"close\"\n            className={classes.closeButton}\n            onClick={handleClose}\n          >\n            <Close />\n          </IconButton>\n        </DialogTitle>\n        <DialogContent>\n          <TextField\n            autoFocus\n            fullWidth\n            id=\"name\"\n            label=\"Scenario name\"\n            margin=\"dense\"\n            value={name}\n            onChange={handleNameChange}\n          />\n        </DialogContent>\n        <DialogContent>\n          <DialogContentText>\n            Modify copy of state before adding\n          </DialogContentText>\n          <SimpleEditor\n            autoHeight\n            initialCode={code}\n            language=\"json\"\n            valueGetter={valueGetter}\n          />\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={handleSubmit}>Submit</Button>\n        </DialogActions>\n      </Dialog>\n    </>\n  );\n}\n","import React, { useState, MouseEvent } from 'react';\nimport IconButton from '@material-ui/core/IconButton';\nimport Menu from '@material-ui/core/Menu';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\n\nconst ITEM_HEIGHT = 48;\n\nexport default function ServerStateMenu({\n  actions,\n}: {\n  actions: Array<{ label: string; onClick: () => void }>;\n}) {\n  const [anchorEl, setAnchorEl] = useState<null | HTMLElement>(null);\n  const open = Boolean(anchorEl);\n  const handleClick = (event: MouseEvent<HTMLElement>) => {\n    setAnchorEl(event.currentTarget);\n  };\n  const handleClose = () => {\n    setAnchorEl(null);\n  };\n\n  function handleActionClick(action: () => void) {\n    return () => {\n      handleClose();\n      action();\n    };\n  }\n\n  return (\n    <div>\n      <IconButton\n        aria-controls=\"server-state-menu\"\n        aria-haspopup=\"true\"\n        aria-label=\"more\"\n        onClick={handleClick}\n      >\n        <MoreVertIcon />\n      </IconButton>\n      <Menu\n        keepMounted\n        anchorEl={anchorEl}\n        id=\"server-state-menu\"\n        open={open}\n        PaperProps={{\n          style: {\n            maxHeight: ITEM_HEIGHT * 4.5,\n            width: 200,\n          },\n        }}\n        onClose={handleClose}\n      >\n        {actions.map(({ label, onClick }) => (\n          <MenuItem key={label} onClick={handleActionClick(onClick)}>\n            {label}\n          </MenuItem>\n        ))}\n      </Menu>\n    </div>\n  );\n}\n","import { Typography } from '@material-ui/core';\nimport Button from '@material-ui/core/Button';\nimport Paper from '@material-ui/core/Paper';\nimport React, { useContext, useState } from 'react';\nimport ReactJson from 'react-json-view';\nimport { ServerState as ServerStateInterface } from '../../../sharedTypes';\nimport { AppStateContext } from '../../App';\nimport { Editor } from '../../common/Editor';\nimport AddServerScenario from './add-server-scenario/AddServerScenario';\nimport ServerStateMenu from './ServerStateMenu';\n\nexport default function ServerState() {\n  const {\n    serverState,\n    resetServerState,\n    updateServerState,\n    deleteStateScenario,\n  } = useContext(AppStateContext);\n  const [editing, setEditing] = useState(false);\n  const [invalidJson, setInvalidJson] = useState(false);\n  const [draftCode, setDraftCode] = useState(\n    JSON.stringify(serverState, null, 2),\n  );\n\n  function handleStartEditing() {\n    setEditing(true);\n  }\n\n  function handleDoneEditing() {\n    setEditing(false);\n    updateServerState(JSON.parse(draftCode) as ServerStateInterface);\n  }\n\n  function handleSave(code: string) {\n    setDraftCode(code);\n    try {\n      JSON.parse(code);\n      setInvalidJson(false);\n    } catch (e) {\n      setInvalidJson(true);\n    }\n  }\n\n  async function handleUpdateWithClipboard() {\n    const serverState = await navigator.clipboard.readText();\n\n    try {\n      updateServerState(JSON.parse(serverState));\n    } catch (e) {\n      console.error(['handleUpdateWithClipboard.error'], e.toString());\n    }\n  }\n\n  function handleDeleteScenario() {\n    deleteStateScenario();\n  }\n\n  async function handleCopyToClipboard() {\n    await navigator.clipboard.writeText(JSON.stringify(serverState, null, 2));\n  }\n\n  return (\n    <>\n      <div\n        style={{\n          display: 'flex',\n          justifyContent: 'space-between',\n          alignItems: 'center',\n        }}\n      >\n        <Typography style={{ margin: 8 }} variant=\"h5\">\n          Server state\n        </Typography>\n        <div style={{ display: 'flex' }}>\n          {editing ? (\n            <Button disabled={invalidJson} onClick={handleDoneEditing}>\n              Done\n            </Button>\n          ) : (\n            <Button onClick={handleStartEditing}>Edit</Button>\n          )}\n          <AddServerScenario />\n          <ServerStateMenu\n            actions={[\n              { label: 'Reset server', onClick: resetServerState },\n              { label: 'Copy to clipboard', onClick: handleCopyToClipboard },\n              {\n                label: 'Update with clipboard',\n                onClick: handleUpdateWithClipboard,\n              },\n              { label: 'Delete scenario', onClick: handleDeleteScenario },\n            ]}\n          />\n        </div>\n      </div>\n      <Paper style={{ padding: 10 }}>\n        {!editing && <ReactJson name=\"state\" src={serverState} />}\n        {editing && (\n          <Editor\n            autoHeight\n            code={draftCode}\n            language=\"json\"\n            onSave={handleSave}\n          />\n        )}\n      </Paper>\n    </>\n  );\n}\n"],"sourceRoot":""}